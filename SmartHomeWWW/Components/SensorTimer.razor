@using System.Threading
@using Humanizer
@using Humanizer.Localisation

<em>@TimeSince.Humanize(precision:3, minUnit: TimeUnit.Second)</em>

@code {
    [Parameter]
    public DateTime StartTime { get; init; }

    private TimeSpan TimeSince => DateTime.UtcNow - StartTime;

    private Timer _timer;

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        _timer = new(async (object stateInfo) =>
        {
            await InvokeAsync(StateHasChanged);
        }, new AutoResetEvent(false), 1000 - TimeSince.Milliseconds, 1000);
    }
}
